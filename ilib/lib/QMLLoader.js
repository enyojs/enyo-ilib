var ilib=require("./ilib.js");var path=require("./Path.js");var Loader=require("./Loader.js");var ZoneInfoFile=require("./ZoneInfo.js");var QMLLoader=function(e){this.fr=e;this.parent.call(this,ilib);this.root=module.filename?path.dirname(path.join(module.filename,"..")):Qt.resolvedUrl("..").toString();this.root=this.root.replace("file://","");if(this.root[this.root.length-1]==="/"){this.root=this.root.substring(0,this.root.length-1)}this.includePath.push(path.join(this.root,"resources"));this._exists(path.join(this.root,"locale"),"localeinfo.json");this._exists("/usr/share/javascript/ilib/locale","localeinfo.json");if(this.fr.exists("/usr/share/zoneinfo")){this.useSystemZoneInfo=true}else{}};QMLLoader.prototype=new Loader;QMLLoader.prototype.parent=Loader;QMLLoader.prototype.constructor=QMLLoader;QMLLoader.prototype._loadFile=function(e,t,o){var i;if(this.useSystemZoneInfo&&e.indexOf("zoneinfo")!==-1){i=this._createZoneFile(e);o&&typeof o==="function"&&o(i)}else if(this.fr.exists(e)){i=this.fr.read(e);o&&typeof o==="function"&&o(i)}else{o&&typeof o==="function"&&o();i=undefined}return i};QMLLoader.prototype._createZoneFile=function(e){var t=e.substring(e.indexOf("zoneinfo"));t=t.substring(0,t.length-5);try{var o=new ZoneInfoFile("/usr/share/"+t);var i=o.getIlibZoneInfo(new Date);return JSON.stringify(i)}catch(r){return undefined}};QMLLoader.prototype._exists=function(e,t){var o=path.normalize(path.join(e,t));if(this.fr.exists(o)){this.includePath.push(e)}};module.exports=QMLLoader;